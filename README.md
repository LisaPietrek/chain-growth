# Hierarchical chain growth
Grow ensembles of disordered biomolecules from fragment libraries

## Overview
Algorithm to assemble full-length chains of disordered proteins / regions from short overlapping fragments [1]. 
As input to perform the hierarchical chain growth (HCG) you need the sequence of the desired IDP and provide a fragment library. 
Fragment libraries are typically generated by molecular dynamics simulations. 

Experimental information on local conformations can be used to improve the quality of ensembles in 
reweighted hierarchical chain growth (RHCG) [2].

We provide some example scripts for a truncated tau K18 in the examples folder:
- to prepare the fragments to generate the MD fragment libraries using amber tleap
- (to run replica exchange molecular dynamics simulations of the fragments on a SLURM-based cluster)
- to run hcg or rhcg 
	- MDfragment library + corresponding weights for rhcg

## Installation

Example installation in a new conda enviornment 

```bash
conda create -n hcg_py3.7 python=3.7
conda activate hcg_py3.7
git clone https://github.com/bio-phys/hierarchical-chain-growth.git
cd hierarchical-chain-growth
pip install -e . 
```

Python 3.6+ is required. 

## Inputs
- the sequence or topology file of the desired IDP/IDR as .fasta or .pdb, respectively. If you use .fasta make sure the fasta file contains a "header" in row 1 beginning with ">".
- a MD fragment library. You may prepare the library following the examples given in this repository.
- if you want to perform RHCG: weights for the individual fragments (e.g., from ensemble reweighting against experimental data reporting on _local_ structure properties - such as chemical shifts)

## Examples truncated tauK18
### Prepare fragments
- use amber tleap to generate (end-capped) fagments of desired length and with desired overlap
- generally for generate_fragmemnt.py you need as input a fasta or pdb file to get the sequence of the IDP/IDR you want to grow
- here we show the procedure using truncated tauK18 sequence as inout(in form of a fasta file)
- output is a txt file containint all the fragments that you need to generate using tleap 
        - the file can be used as input for tleap

### REMD simulation of short fragments to generate MD fragment libraries
_[NOTES!!]_
- example scripts for SLURM-based cluster
- need to be adapted to cluster setup and again benchmarked
- REMD submit scripts for individual fragment - ideally write loop to cover all fragments

### Run chain growth


## References
1 Hierarchical Ensembles of Intrinsically Disordered Proteins at Atomic Resolution in Molecular Dynamics Simulations, 
Lisa M. Pietrek, Lukas S. Stelzl, and Gerhard Hummer,
Journal of Chemical Theory and Computation 2020 16 (1), 725-737, https://pubs.acs.org/doi/abs/10.1021/acs.jctc.9b00809

2 Global Structure of the Intrinsically Disordered Protein Tau Emerges from its Local Structure, 
Lukas S. Stelzl, Lisa M. Pietrek, Andrea Holla, Javier S. Oroz, Mateusz Sikora, Jürgen Köfinger, Benjamin Schuler, Markus Zweckstetter, Gerhard Hummer, 
bioarxiv, http://dx.doi.org/10.1101/2021.11.23.469691
